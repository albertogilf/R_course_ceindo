---
title: "Análisis estadístico"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Modelado estadístico: las dos culturas
En el artículo clásico [Statistical modeling: The two cultures]((https://projecteuclid.org/journals/statistical-science/volume-16/issue-3/Statistical-Modeling--The-Two-Cultures-with-comments-and-a/10.1214/ss/1009213726.full)) encontramos 

> There are two cultures in the use of statistical modeling to reach conclusions from
data. One assumes that the data are generated by a given stochastic data model. The
other uses algorithmic models and treats the data mechanism as unknown. (Leo Breiman)

* *Explanatory modeling*: modelos estadísticos empleados para probar una teoría (causal?).
Para ello se emplean variables con un significado científico claro y se evalúa si tienen 
una relación *significativa* con la variable de interés. $\rightarrow$ "Estadística clásica"
basada en **modelos lineales**.
* *Predictive modeling*: modelos cuyo propósito es predecir observaciones nuevas 
o futuras. $\rightarrow$ **Aprendizaje automático** (*machine learning*).

En este notebooks nos centraremos en modelos lineales y en los métodos de inferencia
clásica. El siguiente notebook cubre modelos basados en aprendizaje automático.

(Otras lecturas interesante sobre las dos culturas es [To explain or to predict?](https://www.stat.berkeley.edu/~aldous/157/Papers/shmueli.pdf).)

## Regression is all you need

El modelo básico sobre el que se construye gran parte de la "Estadística clásica"
es el modelo de **regresión lineal**:
$$y = a + b\cdot x + \epsilon$$
donde $\epsilon \sim \mathcal{N}(0, \sigma^2)$.

Es instructivo simular datos que sigan este modelo para entender el significado
de la ecuación:

```{r sim}
x = seq(-2, 2, 0.1)
expected_behaviour = 2 + 3 * x  # a = 2 y b = 3
epsilon = rnorm(length(x), sd = 1)
y = expected_behaviour + epsilon

plot(x, y)
lines(x, expected_behaviour, col = 2)
```

Podemos pensar que `expected_behaviour` es el comportamiento medio o esperado
en la población de interés, mientras que $\epsilon$ representan fluctuaciones 
aleatorias (bien debidas a errores del proceso de medición o que el proceso 
estudiado tiene cierta aleatoriedad). Además, la relación entre $x$ e $y$ es muy
específica. Si aumenta (disminuye) $x$ aumenta (disminuye) $y$. Además, un 
incremento de una unidad en $x$ siempre produce el mismo incremento en $y$ (ídem
si $x$ disminuye). Se dice que la relación entre $x$ e $y$ es **lineal**.

La primera pregunta a la que nos enfrentamos es la siguiente. Dados los datos
$(x, y)$, ¿podemos estimar `expected behaviour`? 

![](https://media.giphy.com/media/l0ErOholJjSmFlMFG/giphy.gif)



